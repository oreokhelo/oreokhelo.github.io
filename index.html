<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Oreo - Snack Plans</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  ::-webkit-scrollbar { height: 8px;}
  ::-webkit-scrollbar-thumb { background-color: #f59e0b; border-radius: 4px; }
  body { background: #f3f4f6; -webkit-font-smoothing: antialiased; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
  button:focus-visible { outline: 2px solid #ea580c; outline-offset: 2px; }
</style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 bg-gray-100">

<!-- HEADER & BANNER (kept very similar to your original) -->
<header class="w-full max-w-md bg-yellow-400 rounded-lg overflow-hidden shadow-md mb-3">
  <div class="relative h-40 bg-yellow-400">
    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/5ff22071-c2fd-4007-b6c5-6e680b8325b5.png" class="object-cover w-full h-full" onerror="this.style.display='none'"/>
  </div>
  <section class="bg-white rounded-b-lg text-center px-5 py-4 -mt-4 relative z-10 shadow-sm">
    <div class="flex justify-center items-center space-x-3">
      <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/1c8276c5-802c-4cfd-ada4-6469c90d0a32.png" class="w-14 h-14 rounded-full border-4 border-white -mt-8 shadow-md" onerror="this.style.display='none'"/>
      <div>
        <p id="displayPhone" class="font-semibold text-gray-700 tracking-wide">Guest</p>
        <p id="displayName" class="text-sm text-gray-500">Not logged in</p>
      </div>
    </div>

    <div class="flex justify-center mt-3 gap-6 text-xs">
      <span id="vipTag" class="flex items-center gap-1 px-3 py-[2px] rounded-full bg-indigo-200 text-indigo-800 font-semibold">VIP0</span>
      <span class="text-gray-300 font-bold select-none">|</span>
      <a href="login.html" id="loginLink" class="text-xs text-blue-700 font-semibold">Login / Signup</a>
    </div>

    <div class="mt-4 grid grid-cols-3 gap-3 bg-gray-50 p-3 rounded-lg shadow-inner">
      <div class="text-center">
        <p id="balNumber" class="text-2xl font-bold text-gray-900">0</p>
        <p class="text-xs text-gray-500">Balance</p>
      </div>
      <div class="text-center border-x border-gray-300">
        <p id="rechargeNumber" class="text-2xl font-bold text-gray-900">₹0</p>
        <p class="text-xs text-gray-500">Recharge</p>
      </div>
      <div class="text-center">
        <p id="incomeNumber" class="text-2xl font-bold text-gray-900">0</p>
        <p class="text-xs text-gray-500">Total income</p>
      </div>
    </div>

    <div class="mt-4 grid grid-cols-4 gap-1">
      <button aria-label="Recharge" id="btnRecharge" class="bg-yellow-300 rounded-lg py-3 flex flex-col items-center text-gray-800 font-semibold hover:bg-yellow-400 transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" >
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v8m4-4H8" />
          <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" fill="none"/>
        </svg>
        Recharge
      </button>
      <button aria-label="Withdraw" id="btnWithdraw" class="bg-yellow-300 rounded-lg py-3 flex flex-col items-center text-gray-800 font-semibold hover:bg-yellow-400 transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" >
          <path stroke-linecap="round" stroke-linejoin="round" d="M16 8l-4 4-4-4" />
          <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" fill="none"/>
        </svg>
        Withdraw
      </button>
      <button aria-label="Share" id="btnShare" class="bg-yellow-300 rounded-lg py-3 flex flex-col items-center text-gray-800 font-semibold hover:bg-yellow-400 transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" >
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 12h6m-6 0l-6 6m6-6l-6-6" />
        </svg>
        Share
      </button>
      <button aria-label="Online" id="btnOnline" class="bg-yellow-300 rounded-lg py-3 flex flex-col items-center text-gray-800 font-semibold hover:bg-yellow-400 transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" >
          <circle cx="12" cy="12" r="3" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M2 12a10 10 0 0110-10m0 20a10 10 0 01-10-10" />
        </svg>
        Online
      </button>
    </div>

    <nav aria-label="Tabs" class="mt-3 bg-yellow-300 rounded-lg flex divide-x divide-yellow-400 text-xs font-semibold text-gray-700 select-none overflow-hidden">
      <button id="tabDaily" class="flex-grow py-1 bg-yellow-400 transition-colors" aria-current="page">Daily income</button>
      <button id="tabBenefits" class="flex-grow py-1">Benefits Program</button>
    </nav>
  </section>
</header>

<!-- PLANS -->
<main class="w-full max-w-md space-y-4 mb-16">
  <!-- Plan A -->
  <section class="bg-white rounded-lg shadow">
    <div class="relative">
      <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/23cdb047-5d55-4a47-9291-372e8a4e61c1.png" class="w-full h-44 object-cover rounded-t-lg" onerror="this.style.display='none'"/>
      <span class="absolute bottom-2 left-2 rounded bg-black bg-opacity-60 text-white text-xs px-2 py-0.5 font-semibold">Plan-A</span>
    </div>
    <div class="p-3 space-y-1 font-semibold text-gray-900">
      <div class="flex justify-between text-sm"><span>₹1465.00 Price</span><span>₹416 Daily</span></div>
      <div class="flex justify-between text-sm"><span>91 Days</span><span>₹37856.00 Total</span></div>
      <button class="buy-btn w-full mt-2 bg-yellow-500 text-white py-2 rounded hover:bg-yellow-600 transition" data-plan="Plan-A" data-price="1465" data-daily="416" data-duration="91">Buy now</button>
    </div>
  </section>

  <!-- Plan B -->
  <section class="bg-white rounded-lg shadow">
    <div class="relative">
      <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/3ed163b6-b97e-4aad-bef1-4d07263c029b.png" class="w-full h-44 object-cover rounded-t-lg" onerror="this.style.display='none'"/>
      <span class="absolute bottom-2 left-2 rounded bg-black bg-opacity-60 text-white text-xs px-2 py-0.5 font-semibold">Plan-B</span>
    </div>
    <div class="p-3 space-y-1 font-semibold text-gray-900">
      <div class="flex justify-between text-sm"><span>₹497.00 Price</span><span>₹130.00 Daily</span></div>
      <div class="flex justify-between text-sm"><span>35 Days</span><span>₹4550.00 Total</span></div>
      <button class="buy-btn w-full mt-2 bg-yellow-500 text-white py-2 rounded hover:bg-yellow-600 transition" data-plan="Plan-B" data-price="497" data-daily="130" data-duration="35">Buy now</button>
    </div>
  </section>

  <!-- other plans (coming soon) -->
  <!-- C..I kept them as disabled like your original -->
  <section class="bg-white rounded-lg shadow">
    <div class="relative">
      <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/3d506ff5-2669-457a-bf7a-bc93a86410d4.png" class="w-full h-44 object-cover rounded-t-lg" onerror="this.style.display='none'"/>
      <span class="absolute bottom-2 left-2 rounded bg-black bg-opacity-60 text-white text-xs px-2 py-0.5 font-semibold">Plan-C</span>
    </div>
    <div class="p-3 space-y-1 font-semibold text-gray-900">
      <div class="flex justify-between text-sm"><span>₹4900.00 Price</span><span>₹1404.00 Daily</span></div>
      <div class="flex justify-between text-sm"><span>120 Days</span><span>₹168480.00 Total</span></div>
      <button disabled class="w-full mt-2 bg-gray-400 text-gray-700 py-2 rounded cursor-not-allowed">Coming soon</button>
    </div>
  </section>

  <!-- add rest as needed... -->
</main>

<!-- BOTTOM NAV -->
<nav class="fixed bottom-0 left-0 w-full max-w-md bg-white border-t border-gray-300 flex justify-around text-xs text-gray-600 shadow-inner py-2">
  <button aria-label="Home" id="navHome" class="flex flex-col items-center text-yellow-600 font-semibold">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-0.5" fill="currentColor" viewBox="0 0 24 24" >
      <path d="M3 9.5l9-7 9 7V20a1 1 0 01-1 1h-5v-6H9v6H4a1 1 0 01-1-1V9.5z" />
    </svg>
    Home
  </button>
  <button aria-label="Team" id="navTeam" class="flex flex-col items-center hover:text-yellow-600 transition">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" >
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20H4v-2a4 4 0 013-3.87M12 12a5 5 0 100-10 5 5 0 000 10z"/>
    </svg>
    Team
  </button>
  <button aria-label="Devices" id="navDevices" class="flex flex-col items-center hover:text-yellow-600 transition">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" >
      <rect x="2" y="7" width="20" height="12" rx="2" ry="2"/>
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 3h-8v4h8V3z"/>
    </svg>
    Devices
  </button>
  <button aria-label="My Profile" id="navProfile" class="flex flex-col items-center hover:text-yellow-600 transition">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" >
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A9 9 0 1118 14"/>
    </svg>
    My
  </button>
</nav>

<script>
/* ----------------- Utilities for localStorage (users & auth) ----------------- */
function getUsers(){ return JSON.parse(localStorage.getItem('users')||'[]'); }
function saveUsers(u){ localStorage.setItem('users', JSON.stringify(u)); }
function getCurrentUserPhone(){ return localStorage.getItem('currentUser') || null; }
function logout(){ localStorage.removeItem('currentUser'); location.href='login.html'; }

// compute pending incomes for given user object (updates user)
function computePendingIncomeForUser(user){
  const now = new Date();
  user.subscriptions = user.subscriptions || [];
  user.subscriptions.forEach(sub => {
    const started = new Date(sub.startDate);
    const daysPassed = Math.floor((now - started)/(1000*60*60*24));
    const daysEligible = Math.min(Math.max(daysPassed,0), sub.duration);
    const already = sub.earnedAlreadyDays||0;
    const toCreditDays = daysEligible - already;
    if(toCreditDays > 0){
      const earn = toCreditDays * sub.daily;
      user.balance = (user.balance||0) + earn;
      user.totalIncome = (user.totalIncome||0) + earn;
      sub.earnedAlreadyDays = already + toCreditDays;
    }
  });
}

/* ----------------- On page load: show user info & compute incomes ----------------- */
let currentPhone = getCurrentUserPhone();
let users = getUsers();
let user = null;

if(currentPhone){
  user = users.find(u=>u.phone===currentPhone);
  if(!user){ localStorage.removeItem('currentUser'); currentPhone=null; }
  else if(user.blocked){ alert('Your account is blocked.'); localStorage.removeItem('currentUser'); currentPhone=null; }
}

const displayPhoneEl = document.getElementById('displayPhone');
const displayNameEl = document.getElementById('displayName');
const vipTagEl = document.getElementById('vipTag');
const balNum = document.getElementById('balNumber');
const incomeNum = document.getElementById('incomeNumber');
const rechargeNum = document.getElementById('rechargeNumber');
const loginLink = document.getElementById('loginLink');

function refreshUI(){
  users = getUsers();
  if(getCurrentUserPhone()){
    user = users.find(u=>u.phone===getCurrentUserPhone());
  } else user = null;

  if(user){
    // compute incomes
    computePendingIncomeForUser(user);
    saveUsers(users);

    displayPhoneEl.innerText = user.phone;
    displayNameEl.innerText = user.name || '';
    vipTagEl.innerText = user.vip || 'VIP0';
    balNum.innerText = (user.balance||0).toFixed(2);
    incomeNum.innerText = (user.totalIncome||0).toFixed(2);
    rechargeNum.innerText = '₹' + (user.balance||0).toFixed(2);
    loginLink.innerText = 'Logout';
    loginLink.href = 'javascript:void(0)';
    loginLink.onclick = ()=>{ if(confirm('Logout?')){ logout(); } };
  } else {
    displayPhoneEl.innerText = 'Guest';
    displayNameEl.innerText = 'Not logged in';
    vipTagEl.innerText = 'VIP0';
    balNum.innerText = '0';
    incomeNum.innerText = '0';
    rechargeNum.innerText = '₹0';
    loginLink.innerText = 'Login / Signup';
    loginLink.href = 'login.html';
    loginLink.onclick = null;
  }
}
refreshUI();

/* ----------------- top buttons actions ----------------- */
document.getElementById('btnRecharge').onclick = ()=> {
  if(!user){ location.href='login.html'; return; }
  location.href = 'payment.html';
};
document.getElementById('btnWithdraw').onclick = ()=> {
  if(!user){ location.href='login.html'; return; }
  location.href = 'withdraw.html';
};
document.getElementById('btnShare').onclick = ()=> {
  const link = 'https://your-invite-link.com/?ref=' + (user?user.phone:'guest');
  navigator.clipboard.writeText(link).then(()=> alert('Share link copied!'));
};
document.getElementById('btnOnline').onclick = ()=> { alert('Online Support: Please contact admin@demo'); };

/* ----------------- Tabs ----------------- */
document.getElementById('tabDaily').onclick = ()=>{ document.getElementById('tabDaily').classList.add('bg-yellow-400'); document.getElementById('tabBenefits').classList.remove('bg-yellow-400'); alert('Daily income tab'); };
document.getElementById('tabBenefits').onclick = ()=>{ document.getElementById('tabBenefits').classList.add('bg-yellow-400'); document.getElementById('tabDaily').classList.remove('bg-yellow-400'); alert('Benefits program'); };

/* ----------------- buy buttons ----------------- */
document.querySelectorAll('.buy-btn').forEach(btn=>{
  btn.onclick = ()=>{
    if(!user){ location.href='login.html'; return; }
    // read plan data
    const plan = btn.dataset.plan;
    const price = Number(btn.dataset.price);
    const daily = Number(btn.dataset.daily);
    const duration = Number(btn.dataset.duration);

    if(user.balance < price){ if(confirm("Insufficient balance. Recharge now?")) location.href='payment.html'; return; }

    // Deduct price, create subscription
    user.balance = (user.balance||0) - price;
    const sub = { plan, price, daily, duration, startDate: new Date().toISOString(), earnedAlreadyDays: 0 };
    user.subscriptions = user.subscriptions || [];
    user.subscriptions.push(sub);
    users = users.map(u => u.phone===user.phone ? user : u);
    saveUsers(users);
    alert(plan + " purchased! Daily income will start from today.");
    refreshUI();
  }
});

/* ----------------- bottom nav ----------------- */
document.getElementById('navHome').onclick = ()=> { location.href='index.html'; };
document.getElementById('navTeam').onclick = ()=> { if(!user) location.href='login.html'; else location.href='team.html'; };
document.getElementById('navDevices').onclick = ()=> { if(!user) location.href='login.html'; else location.href='devices.html'; };
document.getElementById('navProfile').onclick = ()=> { if(!user) location.href='login.html'; else location.href='profile.html'; };

/* ----------------- auto-save to keep consistent ----------------- */
window.addEventListener('beforeunload', ()=> saveUsers(users));
</script>
</body>
</html>
